y = "total local discoveries",
x = "length of chain")
df_discovery %>%
ggplot(mapping = aes(x=tries,y=global_discoveries)) +
geom_point(aes(color = factor(condition)), alpha=0.5, position = position_jitter(width=0.2, height=0.2)) +
scale_color_manual(values = c("red", "blue")) +
scale_x_continuous(breaks = round(seq(2, 11, by = 1),1)) +
scale_y_continuous(breaks = round(seq(1, 10, by = 1),1)) +
labs(title = "Number of systems discovered by chains of different lengths",
y = "total global discoveries",
x = "length of chain")
head(df_discovery)
subset(df_discovery,tries==2)
nrow(subset(df_discovery,tries==2))
subset(df1,trajectory==38)
df1 <- read.csv("../../Data/experiment1_FINAL.csv", colClasses=c(system1024="character"))
df2 <- read.csv("../../Data/experiment2_FINAL.csv", colClasses=c(system1024="character"))
df1i <- subset(df1,condition=="I")
df1c <- subset(df1,condition=="C")
df2i <- subset(df2,condition=="I")
df2c <- subset(df2,condition=="C")
length(unique(df1$system512))/nrow(df1)    # 188 / 642 = 0.293 - the probability that each try results in discovery of a new system
length(unique(df1i$system512))/nrow(df1i)  # 159 / 435 = 0.366
length(unique(df1c$system512))/nrow(df1c)  #  75 / 207 = 0.362
0.366*435
75/45
207/45
435/90
names(df1)
df$convergecd
df$converged
df <- df1
convergedIDs <- unique(subset(df,converged==TRUE)$trajectory)
convergedIDs
length(convergedIDs)
df_converged_chains <- function(df) {
convergedIDs <- unique(subset(df,converged==TRUE)$trajectory)
dfconv <- df[df$trajectory %in% convergedIDs,]
return(dfconv)
}
df1conv <- df_converged_chains(df1)
nrow(df1)
nrow(df1conv)
df1conv$converged
df1conv$condition
table(df1conv$condition)
df1i_conv <- subset(df1conv,condition=="I")
df1i_conv <- subset(df1conv,condition=="I")
df1c_conv <- subset(df1conv,condition=="C")
length(unique(df1i_conv$system512))/nrow(df1i_conv)
length(unique(df1i_conv$system512))
nrow(df1i_conv)
length(unique(df1c_conv$system512))/nrow(df1c_conv)  #
length(unique(df1c_conv$system512))
nrow(df1c_conv)
length(unique(df1i_conv$system512))/nrow(df1i_conv)  # 100 / 347 =
ncats <- rep(NA,500)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,500)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:500) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)
ncats[i] <- length(unique(df1i$system512[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system512[df1i$trajectory %in% samples])
}
mean(ncats) # about 95-96
sd(ncats)   # about 9-11
length(unique(df1c$system512)) # 75 uniques
N <- 500
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
mean(ncats) # about 113-114
sd(ncats)   # about 9-11
length(unique(df1c$system1024)) # 91 uniques
samples
length(samples)
ncats
length(ncats)
sort(ncats)
N <- 1000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
mean(ncats) # about 113-114
sd(ncats)   # about 9-11
length(unique(df1c$system1024)) # 91 uniques
N <- 10000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
min(ncats)
max(ncats)  #
N <- 100
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
1000*95
1000*.95
1000-950
50/2
1000-25
25+950
length(ncats)*2.5
N <- 1000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
min(ncats)  # 77
max(ncats)  # 151
length(ncats)*2.5
length(ncats)
length(ncats)*.025
ceil(5.6)
ceiling(5.6)
ceiling(5.1)
values
ceiling(length(ncats)*.025)+1
floor(4.5)
N <- 90
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
length(ncats)
length(ncats)*.025
N <- 1000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
length(ncats)*.025
ceiling(length(ncats)*.025)+1
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- ceiling(length(ncats)*.025)+1 }
if (type == "upper") { result <- floor(length(ncats)*.925) }
}
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- ceiling(length(my_list)*.025)+1 }
if (type == "upper") { result <- floor(length(my_list)*.925) }
}
bound95(ncats"lower")
bound95(ncats,"lower")
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- ceiling(length(my_list)*.025)+1 }
if (type == "upper") { result <- floor(length(my_list)*.925) }
return(result)
}
bound95(ncats,"lower")
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- my_list[ceiling(length(my_list)*.025)+1] }
if (type == "upper") { result <- my_list[floor(length(my_list)*.925)] }
return(result)
}
bound95(ncats,"lower")
bound95(ncats,"upper")
sort(ncats)
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- my_list[ceiling(length(my_list)*.025)+1] }
if (type == "upper") { result <- my_list[floor(length(my_list)*.925)] }
return(result)
}
sort(ncats)
bound95(ncats,"lower")
bound95(ncats,"upper")
ceiling(length(my_list)*.025)+1
ceiling(length(ncats)*.025)+1
ncats([26])
ncats[26]
ncats
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- sorted[ceiling(length(my_list)*.025)+1] }
if (type == "upper") { result <- sorted[floor(length(my_list)*.925)] }
return(result)
}
sort(ncats)
bound95(ncats,"lower")
bound95(ncats,"upper")
ncats(26)
ncats[26]
ncats[25]
N <- 10000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
min(ncats)  # 77
max(ncats)  # 151
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- sorted[ceiling(length(my_list)*.025)+1] }
if (type == "upper") { result <- sorted[floor(length(my_list)*.925)] }
return(result)
}
sort(ncats)
bound95(ncats,"lower")
bound95(ncats,"upper")
N <- 100000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
min(ncats)  # 72
max(ncats)  # 154
bound95(ncats,"lower")  # 94
bound95(ncats,"upper")  # 129
N <- 500
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:500) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system512[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system512[df1i$trajectory %in% samples])
}
N <- 10000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system512[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system512[df1i$trajectory %in% samples])
}
bound95(ncats,"lower")  #
bound95(ncats,"upper")  #
length(unique(df1c$system1024))
length(unique(df1c$system512))
N <- 500
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
rates <- ncats/ntries
N <- 10000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
rates <- ncats/ntries
rates <- ncats/ntries
bound95(rates,"lower")  #
sort(rates)
bound95(rates,"lower")  #
length(rates)
length(rates)*.925
length(rates)*.025
rates <- ncats/ntries
bound95(rates,"lower")  #
bound95(rates,"upper")  #
N <- 10000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
rates <- ncats/ntries
bound95(rates,"lower")  # 0.4536585
bound95(rates,"upper")  # 0.5753425
N <- 10000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
mean(ncats) # about 113-114
sd(ncats)   # about 9-11
length(unique(df1c$system1024)) # 91 uniques
mean(ntries)  # about 216-218
nrow(df1c)    # 207 tries
435/2
min(ncats)  # 72
max(ncats)  # 154
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- sorted[ceiling(length(my_list)*.025)+1] }
if (type == "upper") { result <- sorted[floor(length(my_list)*.925)] }
return(result)
}
bound95(ncats,"lower")  # 94
bound95(ncats,"upper")  # 129
length(unique(df1c$system1024))
rates <- ncats/ntries
bound95(rates,"lower")  # 0.4527363
bound95(rates,"upper")  # 0.5765766
N <- 100000
ncats <- rep(NA,N)   # total unique category systems found by that sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,length(unique(df1c$trajectory)),replace=FALSE)  # sample 45 chains from condition I
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
min(ncats)  # 72
max(ncats)  # 154
bound95(ncats,"lower")  # 94
bound95(ncats,"upper")  # 129
length(unique(df1c$system1024))
rates <- ncats/ntries
a <- c(6,4,2)
b <- c(3,2,1)
a/b
b/a
c <- c(1,2,3)
a/b
a/c
2/3
bound95(rates,"lower")  # 0.4527363
bound95(rates,"upper")  # 0.5765766
hist(rates)
hist(rates)
abline(v=0.5)
abline(v=0.5,col="red")
hist(rates)
abline(v=0.4528736,col="red")
knitr::opts_chunk$set(echo = TRUE)
df1 <- read.csv("../../Data/experiment1_FINAL.csv", colClasses=c(system1024="character"))
size
MCMC <- function(N,subsamples) {
ncats <- rep(NA,N)   # total unique category systems found by the sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,subsamples,replace=FALSE)
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
}
MCMC <- function(N,subsamples) {
ncats <- rep(NA,N)   # total unique category systems found by the sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,subsamples,replace=FALSE)
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
}
MCMC <- function(N,subsamples) {
ncats <- rep(NA,N)   # total unique category systems found by the sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,subsamples,replace=FALSE)
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
return(list(ncats,ntries))
}
bound95 <- function(my_list,type) {
sorted <- sort(my_list)
if (type == "lower") { result <- sorted[ceiling(length(my_list)*.025)+1] }
if (type == "upper") { result <- sorted[floor(length(my_list)*.925)] }
return(result)
}
result <- MCMC(10000,45)
result
result[1]
result[[1]]
result <- MCMC(10000,45)
result <- MCMC(10000,45)
cats <- result[[1]]
tries <- result[[2]]
hist(cats)
hist(cats,col="lightblue")
line(v=90,col="red")
cats <- result[[1]]
tries <- result[[2]]
hist(cats,col="lightblue")
line(v=90,col="red")
result <- MCMC(10000,45)
cats <- result[[1]]
tries <- result[[2]]
hist(cats,col="lightblue")
abline(v=90,col="red")
result <- MCMC(10000,45)
cats <- result[[1]]
tries <- result[[2]]
length(unique(df1i$system1024))
197/2
MCMC2 <- function(N,subsamples) {
ncats <- rep(NA,N)   # total unique category systems found by the sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,subsamples,replace=TRUE)
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
return(list(ncats,ntries))
}
result <- MCMC2(10000,90)
result <- MCMC2(10000,90)
cats <- result[[1]]
tries <- result[[2]]
tries <- result[[2]]
rates <- cats/tries
result <- MCMC(10000,90)
cats <- result[[1]]
tries <- result[[2]]
rates <- cats/tries
hist(cats,col="lightblue")
abline(v=length(unique(df1i$system1024))/2,col="red")
MCMC2 <- function(N,subsamples) {
ncats <- rep(NA,N)   # total unique category systems found by the sample of 45 chains
ntries <- rep(NA,N)  # put the total number of generations in all sampled chains here (= total tries)
nt <- unique(df1i$trajectory)
for (i in 1:N) {
samples <- sample(nt,subsamples,replace=TRUE)
ncats[i] <- length(unique(df1i$system1024[df1i$trajectory %in% samples]))
ntries[i] <- length(df1i$system1024[df1i$trajectory %in% samples])
}
return(list(ncats,ntries))
}
result <- MCMC2(10000,90)
result <- MCMC2(10000,90)
cats <- result[[1]]
tries <- result[[2]]
rates <- cats/tries
hist(cats,col="lightblue")
abline(v=length(unique(df1i$system1024)),col="red")
cats <- result[[1]]
tries <- result[[2]]
rates <- cats/tries
length(unique(df1i$system1024))
cats
bound95(cats,"lower")
bound95(cats,"upper")
table(cats)
unique(df1i$system1024)
length(unique(df1i$system1024))
head(cats)
head(tries)
head(rates)
table(cats)
unique(df1i$trajectory)
nt <- unique(df1i$trajectory)
nt <- unique(df1i$trajectory)
sample(nt,subsamples,replace=TRUE)
sample(nt,90,replace=TRUE)
samples <- sample(nt,subsamples,replace=TRUE)
samples <- sample(nt,90,replace=TRUE)
samples
length(unique(df1i$system1024[df1i$trajectory %in% samples]))
length(df1i$system1024[df1i$trajectory %in% samples])
153/309
max(cats)
bound95(rates,"lower")
bound95(rates,"upper")
hist(rates,col="lightblue")
abline(v=length(unique(df1i$system1024)),col="red")
